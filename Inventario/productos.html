<!-- productos.html -->
<div class="tab-content active" style="padding: 20px;">
  <h2>📦 Gestión de Productos</h2>
  <p>Administra los productos registrados en el sistema. Puedes agregar, editar o eliminar registros fácilmente.</p>

  <!-- Botón principal -->
  <div class="actions" style="margin: 15px 0;">
    <button onclick="mostrarFormularioProducto()" style="
      background:#007bff;
      color:white;
      border:none;
      padding:10px 16px;
      border-radius:8px;
      cursor:pointer;
      font-weight:600;">
      <i class="fas fa-plus"></i> Nuevo Producto
    </button>
  </div>

  <!-- Formulario de Producto -->
  <div id="formularioProducto" style="
    display:none;
    background:white;
    padding:20px;
    border-radius:10px;
    box-shadow:0 2px 5px rgba(0,0,0,0.1);
    margin-bottom:20px;
  ">
    <h3 id="formTituloProducto">Agregar Producto</h3>
    <input type="hidden" id="productoId">

    <div style="display:flex; flex-wrap:wrap; gap:10px;">
      <input type="text" id="nombreProducto" placeholder="Nombre del producto" style="flex:1; padding:10px; border:1px solid #ccc; border-radius:6px;">
      <input type="text" id="categoriaProducto" placeholder="Categoría" style="flex:1; padding:10px; border:1px solid #ccc; border-radius:6px;">
      <input type="number" id="stockProducto" placeholder="Stock" style="flex:1; padding:10px; border:1px solid #ccc; border-radius:6px;">
      <input type="number" id="precioProducto" placeholder="Precio $" step="0.01" style="flex:1; padding:10px; border:1px solid #ccc; border-radius:6px;">
      <input type="text" id="proveedorProducto" placeholder="Proveedor" style="flex:1; padding:10px; border:1px solid #ccc; border-radius:6px;">
    </div>

    <div style="margin-top:15px;">
      <button onclick="guardarProducto()" style="background:#007bff; color:white; border:none; padding:10px 16px; border-radius:8px; cursor:pointer;">
        <i class="fas fa-save"></i> Guardar
      </button>
      <button onclick="cancelarProducto()" style="background:#ccc; border:none; padding:10px 16px; border-radius:8px; cursor:pointer;">
        Cancelar
      </button>
    </div>
  </div>

  <!-- Tabla de productos -->
  <table id="tablaProductos" style="width:100%; border-collapse:collapse; background:white; box-shadow:0 2px 5px rgba(0,0,0,0.1);">
    <thead style="background:#0066cc; color:white;">
      <tr>
        <th style="padding:10px;">ID</th>
        <th style="padding:10px;">Nombre</th>
        <th style="padding:10px;">Categoría</th>
        <th style="padding:10px;">Stock</th>
        <th style="padding:10px;">Precio</th>
        <th style="padding:10px;">Proveedor</th>
        <th style="padding:10px;">Acciones</th>
      </tr>
    </thead>
    <tbody id="cuerpoProductos">
      <!-- Se llenará dinámicamente -->
    </tbody>
  </table>
</div>

<script>
// --- Datos de ejemplo ---
let productos = [
  { id: 1, nombre: "Manzanas", categoria: "Frutas", stock: 200, precio: 12.5, proveedor: "Frutal MX" },
  { id: 2, nombre: "Zanahorias", categoria: "Verduras", stock: 150, precio: 9.8, proveedor: "Campo Verde" }
];
let editandoProducto = false;

// --- Mostrar formulario ---
function mostrarFormularioProducto(id = null) {
  const form = document.getElementById("formularioProducto");
  form.style.display = "block";

  if (id) {
    const producto = productos.find(p => p.id === id);
    document.getElementById("productoId").value = producto.id;
    document.getElementById("nombreProducto").value = producto.nombre;
    document.getElementById("categoriaProducto").value = producto.categoria;
    document.getElementById("stockProducto").value = producto.stock;
    document.getElementById("precioProducto").value = producto.precio;
    document.getElementById("proveedorProducto").value = producto.proveedor;
    document.getElementById("formTituloProducto").innerText = "Editar Producto";
    editandoProducto = true;
  } else {
    document.getElementById("formTituloProducto").innerText = "Agregar Producto";
    document.getElementById("productoId").value = "";
    document.getElementById("nombreProducto").value = "";
    document.getElementById("categoriaProducto").value = "";
    document.getElementById("stockProducto").value = "";
    document.getElementById("precioProducto").value = "";
    document.getElementById("proveedorProducto").value = "";
    editandoProducto = false;
  }
}

// --- Cancelar formulario ---
function cancelarProducto() {
  document.getElementById("formularioProducto").style.display = "none";
  editandoProducto = false;
}

// --- Guardar o editar producto ---
function guardarProducto() {
  const nombre = document.getElementById("nombreProducto").value.trim();
  const categoria = document.getElementById("categoriaProducto").value.trim();
  const stock = document.getElementById("stockProducto").value.trim();
  const precio = document.getElementById("precioProducto").value.trim();
  const proveedor = document.getElementById("proveedorProducto").value.trim();

  if (!nombre || !categoria || !stock || !precio || !proveedor) {
    alert("Por favor completa todos los campos.");
    return;
  }

  if (editandoProducto) {
    const id = parseInt(document.getElementById("productoId").value);
    const index = productos.findIndex(p => p.id === id);
    productos[index] = { id, nombre, categoria, stock: parseInt(stock), precio: parseFloat(precio), proveedor };
  } else {
    const nuevoId = productos.length ? Math.max(...productos.map(p => p.id)) + 1 : 1;
    productos.push({ id: nuevoId, nombre, categoria, stock: parseInt(stock), precio: parseFloat(precio), proveedor });
  }

  renderProductos();
  cancelarProducto();
}

// --- Eliminar producto ---
function eliminarProducto(id) {
  if (confirm("¿Seguro que deseas eliminar este producto?")) {
    productos = productos.filter(p => p.id !== id);
    renderProductos();
  }
}

// --- Renderizar tabla ---
function renderProductos() {
  const cuerpo = document.getElementById("cuerpoProductos");
  cuerpo.innerHTML = "";
  productos.forEach(p => {
    const fila = `
      <tr>
        <td style="padding:10px; text-align:center;">${p.id}</td>
        <td style="padding:10px;">${p.nombre}</td>
        <td style="padding:10px;">${p.categoria}</td>
        <td style="padding:10px; text-align:center;">${p.stock}</td>
        <td style="padding:10px; text-align:center;">$${p.precio.toFixed(2)}</td>
        <td style="padding:10px;">${p.proveedor}</td>
        <td style="padding:10px; text-align:center;">
          <button onclick="mostrarFormularioProducto(${p.id})" style="background:#ffc107; border:none; padding:6px 10px; border-radius:6px; cursor:pointer;">
            <i class="fas fa-edit"></i>
          </button>
          <button onclick="eliminarProducto(${p.id})" style="background:#dc3545; border:none; padding:6px 10px; border-radius:6px; cursor:pointer; color:white;">
            <i class="fas fa-trash"></i>
          </button>
        </td>
      </tr>
    `;
    cuerpo.innerHTML += fila;
  });
}

// --- Cargar tabla al inicio ---
renderProductos();
</script>
