<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Módulo de Compras - Sistema ERP</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="ComprasStyle.css">
</head>
<body>
    <div class="main-container">
        
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-chart-line"></i> ERP System</h2>
                <p>Sistema Integral de Gestión</p>
            </div>
            
            <ul class="nav-menu">
                <li class="nav-section">
                    <div class="nav-section-title">PRINCIPAL</div>
                </li>
                <li class="nav-item">
                    <a href="/dashboard" class="nav-link">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                
                <li class="nav-section">
                    <div class="nav-section-title">ADMINISTRACIÓN</div>
                </li>
                <li class="nav-item">
                    <a href="/usuarios" class="nav-link">
                        <i class="fas fa-user-shield"></i>
                        <span>Usuarios</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/contabilidad" class="nav-link">
                        <i class="fas fa-calculator"></i>
                        <span>Contabilidad</span>
                    </a>
                </li>
                
                <li class="nav-section">
                    <div class="nav-section-title">VENTAS</div>
                </li>
                <li class="nav-item">
                    <a href="/clientes" class="nav-link">
                        <i class="fas fa-users"></i>
                        <span>Clientes</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/ventas" class="nav-link">
                        <i class="fas fa-shopping-cart"></i>
                        <span>Ventas</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/facturacion" class="nav-link">
                        <i class="fas fa-file-invoice"></i>
                        <span>Facturación</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/punto-venta" class="nav-link">
                        <i class="fas fa-cash-register"></i>
                        <span>Punto de Venta</span>
                    </a>
                </li>
                
                <li class="nav-section">
                    <div class="nav-section-title">COMPRAS</div>
                </li>
                <li class="nav-item">
                    <a href="/proveedores" class="nav-link">
                        <i class="fas fa-truck"></i>
                        <span>Proveedores</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/compras" class="nav-link active">
                        <i class="fas fa-shopping-bag"></i>
                        <span>Compras</span>
                    </a>
                </li>
                
                <li class="nav-section">
                    <div class="nav-section-title">INVENTARIO</div>
                </li>
                <li class="nav-item">
                    <a href="/inventario" class="nav-link">
                        <i class="fas fa-boxes"></i>
                        <span>Inventario</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/almacenes" class="nav-link">
                        <i class="fas fa-warehouse"></i>
                        <span>Almacenes</span>
                    </a>
                </li>
                
                <li class="nav-section">
                    <div class="nav-section-title">RECURSOS HUMANOS</div>
                </li>
                <li class="nav-item">
                    <a href="/rrhh" class="nav-link">
                        <i class="fas fa-user-tie"></i>
                        <span>Empleados</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/nomina" class="nav-link">
                        <i class="fas fa-money-bill-wave"></i>
                        <span>Nómina</span>
                    </a>
                </li>
                
                <li class="nav-section">
                    <div class="nav-section-title">LOGÍSTICA</div>
                </li>
                <li class="nav-item">
                    <a href="/logistica" class="nav-link">
                        <i class="fas fa-shipping-fast"></i>
                        <span>Envíos</span>
                    </a>
                </li>
                
                <li class="nav-section">
                    <div class="nav-section-title">ANÁLISIS</div>
                </li>
                <li class="nav-item">
                    <a href="/reportes" class="nav-link">
                        <i class="fas fa-chart-bar"></i>
                        <span>Reportes</span>
                    </a>
                </li>
                
                <li class="nav-section">
                    <div class="nav-section-title">SISTEMA</div>
                </li>
                <li class="nav-item">
                    <a href="/configuracion" class="nav-link">
                        <i class="fas fa-cog"></i>
                        <span>Configuración</span>
                    </a>
                </li>
            </ul>
            
            <div class="logout-section">
                <button class="btn-logout" onclick="cerrarSesion()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Cerrar Sesión</span>
                </button>
            </div>
        </aside>

        
        <div class="main-content">
            
            
            <header class="page-header">
                <div class="header-left">
                    <button class="mobile-menu-btn" onclick="toggleSidebar()">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div>
                        <h1><i class="fas fa-shopping-bag"></i> Módulo de Compras</h1>
                        <div class="breadcrumb">
                            <a href="/dashboard"><i class="fas fa-home"></i> Inicio</a>
                            <span>/</span>
                            <span>Compras</span>
                        </div>
                    </div>
                </div>
                <div class="header-right">
                    <button class="btn btn-primary" onclick="abrirModalNuevaCompra()" id="btnAccionPrincipal">
                        <i class="fas fa-plus"></i>
                        Nueva Compra
                    </button>
                </div>
            </header>

            
            <div class="tabs-container">
                <div class="tabs-nav">
                    <button class="tab-button active" onclick="cambiarTab('compras')" data-tab="compras">
                        <i class="fas fa-shopping-bag"></i>
                        <span>Órdenes de Compra</span>
                        <span class="tab-badge" id="badgeCompras">0</span>
                    </button>
                    <button class="tab-button" onclick="cambiarTab('proveedores')" data-tab="proveedores">
                        <i class="fas fa-truck"></i>
                        <span>Proveedores</span>
                        <span class="tab-badge" id="badgeProveedores">0</span>
                    </button>
                </div>
            </div>

            
            <div class="tab-content active" id="tab-compras">
                <section class="content-section">
                    
                    
                    <div class="stats-grid">
                        <div class="stat-card" style="border-left-color: var(--azul-principal)">
                            <div class="stat-header">
                                <div class="stat-icon" style="background: linear-gradient(135deg, var(--azul-principal), var(--azul-secundario));">
                                    <i class="fas fa-shopping-bag"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="totalCompras">0</div>
                            <div class="stat-label">Total de Compras</div>
                        </div>

                        <div class="stat-card" style="border-left-color: var(--amarillo-advertencia)">
                            <div class="stat-header">
                                <div class="stat-icon" style="background: linear-gradient(135deg, var(--amarillo-advertencia), var(--amarillo-advertencia-dark));">
                                    <i class="fas fa-clock"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="comprasPendientes">0</div>
                            <div class="stat-label">Compras Pendientes</div>
                        </div>

                        <div class="stat-card" style="border-left-color: var(--verde-exito)">
                            <div class="stat-header">
                                <div class="stat-icon" style="background: linear-gradient(135deg, var(--verde-exito), var(--verde-exito-gradient));">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="comprasRecibidas">0</div>
                            <div class="stat-label">Compras Recibidas</div>
                        </div>

                        <div class="stat-card" style="border-left-color: var(--morado)">
                            <div class="stat-header">
                                <div class="stat-icon" style="background: linear-gradient(135deg, var(--morado), var(--morado-dark));">
                                    <i class="fas fa-dollar-sign"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="montoTotalMes">$0.00</div>
                            <div class="stat-label">Monto Total del Mes</div>
                        </div>
                    </div>

                   
                    <div class="toolbar">
                        <div class="search-box">
                            <i class="fas fa-search input-icon"></i>
                            <input type="text" class="search-input" id="searchCompras" placeholder="Buscar por número de compra, proveedor...">
                        </div>
                        <div class="toolbar-actions">
                            <select class="filter-select" id="estadoFilterCompras">
                                <option value="">Todos los estados</option>
                                <option value="PENDIENTE">Pendiente</option>
                                <option value="RECIBIDA">Recibida</option>
                                <option value="PARCIAL">Parcial</option>
                                <option value="ANULADA">Anulada</option>
                            </select>
                            <button class="btn btn-secondary" onclick="cargarCompras()">
                                <i class="fas fa-sync-alt"></i>
                                Actualizar
                            </button>
                        </div>
                    </div>

                    
                    <div class="table-container">
                        <div class="table-header">
                            <h3 class="table-title">
                                <i class="fas fa-list"></i>
                                Listado de Compras
                            </h3>
                        </div>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>N° Compra</th>
                                    <th>Fecha</th>
                                    <th>Proveedor</th>
                                    <th>Total</th>
                                    <th>Estado</th>
                                    <th>Tipo Pago</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="comprasTableBody">
                                <tr>
                                    <td colspan="7" class="empty-state">
                                        <i class="fas fa-shopping-bag"></i>
                                        <h3>No hay compras registradas</h3>
                                        <p>Comienza creando tu primera orden de compra</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                </section>
            </div>

            
            <div class="tab-content" id="tab-proveedores">
                <section class="content-section">
                    
                    
                    <div class="stats-grid">
                        <div class="stat-card" style="border-left-color: var(--azul-principal)">
                            <div class="stat-header">
                                <div class="stat-icon" style="background: linear-gradient(135deg, var(--azul-principal), var(--azul-secundario));">
                                    <i class="fas fa-truck"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="totalProveedores">0</div>
                            <div class="stat-label">Total Proveedores</div>
                        </div>

                        <div class="stat-card" style="border-left-color: var(--verde-exito)">
                            <div class="stat-header">
                                <div class="stat-icon" style="background: linear-gradient(135deg, var(--verde-exito), var(--verde-exito-gradient));">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="proveedoresActivos">0</div>
                            <div class="stat-label">Proveedores Activos</div>
                        </div>

                        <div class="stat-card" style="border-left-color: var(--rojo-peligro)">
                            <div class="stat-header">
                                <div class="stat-icon" style="background: linear-gradient(135deg, var(--rojo-peligro), var(--rojo-peligro-dark));">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="proveedoresSaldoExcedido">0</div>
                            <div class="stat-label">Saldo Excedido</div>
                        </div>

                        <div class="stat-card" style="border-left-color: var(--morado)">
                            <div class="stat-header">
                                <div class="stat-icon" style="background: linear-gradient(135deg, var(--morado), var(--morado-dark));">
                                    <i class="fas fa-dollar-sign"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="totalDeudaProveedores">$0.00</div>
                            <div class="stat-label">Deuda Total</div>
                        </div>
                    </div>

                    
                    <div class="toolbar">
                        <div class="search-box">
                            <i class="fas fa-search input-icon"></i>
                            <input type="text" class="search-input" id="searchProveedores" placeholder="Buscar proveedor por nombre, RFC...">
                        </div>
                        <div class="toolbar-actions">
                            <select class="filter-select" id="estadoFilterProveedores">
                                <option value="">Todos</option>
                                <option value="ACTIVO">Activos</option>
                                <option value="INACTIVO">Inactivos</option>
                            </select>
                            <button class="btn btn-success" onclick="abrirModalNuevoProveedor()">
                                <i class="fas fa-plus"></i>
                                Nuevo Proveedor
                            </button>
                            <button class="btn btn-secondary" onclick="cargarProveedores()">
                                <i class="fas fa-sync-alt"></i>
                                Actualizar
                            </button>
                        </div>
                    </div>

                    
                    <div class="table-container">
                        <div class="table-header">
                            <h3 class="table-title">
                                <i class="fas fa-list"></i>
                                Listado de Proveedores
                            </h3>
                        </div>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Empresa</th>
                                    <th>RFC</th>
                                    <th>Contacto</th>
                                    <th>Teléfono</th>
                                    <th>Límite Crédito</th>
                                    <th>Saldo Actual</th>
                                    <th>Estado</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="proveedoresTableBody">
                                <tr>
                                    <td colspan="8" class="empty-state">
                                        <i class="fas fa-truck"></i>
                                        <h3>No hay proveedores registrados</h3>
                                        <p>Agrega tu primer proveedor</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                </section>
            </div>

        </div>
    </div>

    
    <div class="modal" id="modalCompra">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalCompraTitle">
                    <i class="fas fa-plus-circle"></i>
                    Nueva Orden de Compra
                </h3>
                <button class="modal-close" onclick="cerrarModal('modalCompra')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="formCompra">
                    <input type="hidden" id="compraId">
                    
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-calendar"></i>
                                Fecha de Compra <span class="required">*</span>
                            </label>
                            <input type="date" class="form-input" id="fechaCompra" required>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-truck"></i>
                                Proveedor <span class="required">*</span>
                            </label>
                            <select class="form-select" id="proveedorId" required>
                                <option value="">Seleccione un proveedor</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-file-invoice"></i>
                                N° Factura Proveedor
                            </label>
                            <input type="text" class="form-input" id="numeroFacturaProveedor" placeholder="Ej: FACT-001">
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-credit-card"></i>
                                Tipo de Pago <span class="required">*</span>
                            </label>
                            <select class="form-select" id="tipoPago" required>
                                <option value="EFECTIVO">Efectivo</option>
                                <option value="TARJETA">Tarjeta</option>
                                <option value="TRANSFERENCIA">Transferencia</option>
                                <option value="CREDITO">Crédito</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-calendar-check"></i>
                                Fecha Entrega Estimada
                            </label>
                            <input type="date" class="form-input" id="fechaEntregaEstimada">
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-percentage"></i>
                                Descuento Global
                            </label>
                            <input type="number" class="form-input" id="descuentoGlobal" value="0" min="0" step="0.01">
                        </div>

                        <div class="form-group full-width">
                            <label class="form-label">
                                <i class="fas fa-comment"></i>
                                Observaciones
                            </label>
                            <textarea class="form-textarea" id="observaciones" placeholder="Notas adicionales sobre la compra..."></textarea>
                        </div>
                    </div>

                    
                    <div class="productos-section">
                        <div class="productos-header">
                            <h4 style="color: var(--azul-principal); font-size: 18px;">
                                <i class="fas fa-boxes"></i> Productos
                            </h4>
                            <button type="button" class="btn btn-success btn-sm" onclick="agregarProducto()">
                                <i class="fas fa-plus"></i> Agregar Producto
                            </button>
                        </div>

                        <table class="productos-table">
                            <thead>
                                <tr>
                                    <th style="width: 40%">Producto</th>
                                    <th style="width: 12%">Cantidad</th>
                                    <th style="width: 15%">Precio Unit.</th>
                                    <th style="width: 12%">Descuento</th>
                                    <th style="width: 15%">Subtotal</th>
                                    <th style="width: 6%"></th>
                                </tr>
                            </thead>
                            <tbody id="productosTableBody">
                                
                            </tbody>
                        </table>

                        
                        <div class="total-section">
                            <div class="total-row">
                                <span>Subtotal:</span>
                                <strong id="subtotalDisplay">$0.00</strong>
                            </div>
                            <div class="total-row">
                                <span>IVA (16%):</span>
                                <strong id="impuestosDisplay">$0.00</strong>
                            </div>
                            <div class="total-row">
                                <span>Descuento:</span>
                                <strong id="descuentoDisplay">$0.00</strong>
                            </div>
                            <div class="total-row final">
                                <span>TOTAL:</span>
                                <strong id="totalDisplay">$0.00</strong>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="cerrarModal('modalCompra')">
                    <i class="fas fa-times"></i>
                    Cancelar
                </button>
                <button type="button" class="btn btn-primary" onclick="guardarCompra()">
                    <i class="fas fa-save"></i>
                    Guardar Compra
                </button>
            </div>
        </div>
    </div>

    
    <div class="modal" id="modalProveedor">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3 class="modal-title" id="modalProveedorTitle">
                    <i class="fas fa-plus-circle"></i>
                    Nuevo Proveedor
                </h3>
                <button class="modal-close" onclick="cerrarModal('modalProveedor')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="formProveedor">
                    <input type="hidden" id="proveedorIdEdit">
                    
                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label class="form-label">
                                <i class="fas fa-building"></i>
                                Nombre de la Empresa <span class="required">*</span>
                            </label>
                            <input type="text" class="form-input" id="nombreEmpresa" required placeholder="Ej: Distribuidora XYZ S.A.">
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-id-card"></i>
                                RFC
                            </label>
                            <input type="text" class="form-input" id="rfcProveedor" placeholder="ABC123456XXX" maxlength="13">
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-phone"></i>
                                Teléfono
                            </label>
                            <input type="tel" class="form-input" id="telefonoProveedor" placeholder="555-1234567">
                        </div>

                        <div class="form-group full-width">
                            <label class="form-label">
                                <i class="fas fa-envelope"></i>
                                Email
                            </label>
                            <input type="email" class="form-input" id="emailProveedor" placeholder="contacto@empresa.com">
                        </div>

                        <div class="form-group full-width">
                            <label class="form-label">
                                <i class="fas fa-map-marker-alt"></i>
                                Dirección
                            </label>
                            <textarea class="form-textarea" id="direccionProveedor" placeholder="Calle, número, colonia, ciudad..."></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-user"></i>
                                Nombre de Contacto
                            </label>
                            <input type="text" class="form-input" id="contactoNombre" placeholder="Juan Pérez">
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-phone-alt"></i>
                                Teléfono de Contacto
                            </label>
                            <input type="tel" class="form-input" id="contactoTelefono" placeholder="555-7654321">
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-dollar-sign"></i>
                                Límite de Crédito
                            </label>
                            <input type="number" class="form-input" id="limiteCreditoProveedor" value="0" min="0" step="0.01">
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-toggle-on"></i>
                                Estado
                            </label>
                            <select class="form-select" id="estadoProveedor">
                                <option value="ACTIVO">Activo</option>
                                <option value="INACTIVO">Inactivo</option>
                            </select>
                        </div>

                        <div class="form-group full-width">
                            <label class="form-label">
                                <i class="fas fa-comment"></i>
                                Observaciones
                            </label>
                            <textarea class="form-textarea" id="observacionesProveedor" placeholder="Notas adicionales..."></textarea>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="cerrarModal('modalProveedor')">
                    <i class="fas fa-times"></i>
                    Cancelar
                </button>
                <button type="button" class="btn btn-primary" onclick="guardarProveedor()">
                    <i class="fas fa-save"></i>
                    Guardar Proveedor
                </button>
            </div>
        </div>
    </div>

    
    <div class="modal" id="modalDetallesCompra">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-file-alt"></i>
                    Detalles de la Compra
                </h3>
                <button class="modal-close" onclick="cerrarModal('modalDetallesCompra')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="detallesCompraContent">
                
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="cerrarModal('modalDetallesCompra')">
                    <i class="fas fa-times"></i>
                    Cerrar
                </button>
            </div>
        </div>
    </div>

    
    <div class="modal" id="modalDetallesProveedor">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-info-circle"></i>
                    Información del Proveedor
                </h3>
                <button class="modal-close" onclick="cerrarModal('modalDetallesProveedor')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="detallesProveedorContent">
                
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="cerrarModal('modalDetallesProveedor')">
                    <i class="fas fa-times"></i>
                    Cerrar
                </button>
            </div>
        </div>
    </div>

</body>
</html>
